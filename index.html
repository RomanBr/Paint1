<!doctype html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title>Pixastic</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="pixastic.js"></script>
    <script src="pixastic.effects.js"></script>
    <script src="pixastic.worker.js"></script>
    <script>
        var img,canvas,ctx,p;
		var img_name = "3.bmp";
		function img_load () {
			img = new Image();
			img.src = img_name;
            canvas = document.getElementById("output-canvas"),
            ctx = canvas.getContext("2d"),
            canvas.width = img.width;
            canvas.height = img.height;
            ctx.drawImage(img, 0, 0);
		}
		
		window.onload = function() {
            img_load(); 
            function doTest(test) {
				canvas.title = test.effect;
                P = new Pixastic(ctx);
                P[test.effect](test.options).done(function() {});
            }
            
            var tests = [
				{ effect : 'morph', options : Math.Max }
            ];
            
            var ul = document.getElementById("testlist"),
                li;
            
            for (var i=0;i<tests.length;i++) {
                li = document.createElement("li");
                li.innerHTML = tests[i].effect;
                li.setAttribute("data-test", i);
                ul.appendChild(li);
            }
            
            ul.addEventListener("click", function(e) {
                var target = e.target || e.srcElement,
                    test;
                if (target.tagName == "LI") {
                    test = tests[target.getAttribute("data-test")];
                    doTest(test);
                }
            }, false);
            
        }
    </script>
</head>
<body>

    <ul id="testlist"></ul>
    <canvas id="output-canvas"></canvas>
</body>
</html>